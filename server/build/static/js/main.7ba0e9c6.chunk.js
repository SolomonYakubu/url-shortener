(this["webpackJsonppoll-app"]=this["webpackJsonppoll-app"]||[]).push([[0],{19:function(e,t,r){},48:function(e,t,r){},73:function(e,t,r){},74:function(e,t,r){"use strict";r.r(t);var a=r(1),o=r(0),n=r.n(o),s=r(17),c=r.n(s),i=(r(48),r(4)),l=r.n(i),p=r(9),u=r(7),d=r(10),b=r.n(d),h=(r(19),r(6)),g=r(3);r(23);function j(){var e=Object(o.useState)(""),t=Object(u.a)(e,2),r=t[0],n=t[1],s=Object(o.useState)(""),c=Object(u.a)(s,2),i=c[0],d=c[1],j=Object(o.useState)(""),f=Object(u.a)(j,2),m=f[0],x=f[1],O=Object(h.e)(),v=function(){var e=Object(p.a)(l.a.mark((function e(t){var a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,b.a.post("http://localhost:3002/user/register",{name:r,email:i,password:m},{headers:{"content-type":"application/json"}});case 4:a=e.sent,O.push("/"),console.log(a.data),e.next=21;break;case 9:e.prev=9,e.t0=e.catch(1),o=e.t0.message.split(" ")[5],e.t1=o,e.next="403"===e.t1?15:"406"===e.t1?17:19;break;case 15:return g.b.error("Mobile number is already registered",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",20);case 17:return g.b.error("Mobile number not valid",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",20);case 19:g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 20:console.log(o);case 21:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"register-container",children:[Object(a.jsx)(g.a,{limit:1}),Object(a.jsx)("form",{className:"register-form",method:"POST",onSubmit:v.bind(this),children:Object(a.jsxs)("div",{className:"register-form-div",children:[Object(a.jsx)("h2",{style:{color:"#5f5f5f"},children:"Register"}),Object(a.jsx)("input",{type:"text",className:"register-name input",placeholder:"Name",value:r,onChange:function(e){return t=e.target.value,void n(t);var t},required:!0}),Object(a.jsx)("input",{type:"email",className:"register-name input",placeholder:"Email",value:i,onChange:function(e){return t=e.target.value,void d(t);var t},required:!0}),Object(a.jsx)("input",{type:"password",className:"register-name input",placeholder:"Password",value:m,onChange:function(e){return t=e.target.value,void x(t);var t},required:!0}),Object(a.jsx)("input",{type:"submit",value:"Register",className:"register-button input"})]})})]})}var f=r(15);function m(){var e=Object(h.e)(),t=Object(o.useState)(""),r=Object(u.a)(t,2),n=r[0],s=r[1],c=Object(o.useState)(""),i=Object(u.a)(c,2),d=i[0],j=i[1],m=function(){var t=Object(p.a)(l.a.mark((function t(r){var a,o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.prev=1,t.next=4,b.a.post("http://localhost:3002/user/login",{email:n,password:d},{headers:{"content-type":"application/json"}});case 4:a=t.sent,o=a.data,localStorage.setItem("token",JSON.stringify(o)),console.log(o),e.push("/poll"),t.next=25;break;case 11:t.prev=11,t.t0=t.catch(1),s=t.t0.message.split(" ")[5],t.t1=s,t.next="403"===t.t1?17:"406"===t.t1?19:"404"===t.t1?21:23;break;case 17:return g.b.error("Mobile number is already registered",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.abrupt("break",24);case 19:return g.b.error("Mobile number not valid",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.abrupt("break",24);case 21:return g.b.error("Mobile number not registered",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.abrupt("break",24);case 23:g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 24:console.log(s);case 25:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"register-container",children:[Object(a.jsx)(g.a,{limit:1}),Object(a.jsxs)("form",{className:"register-form",onSubmit:m.bind(this),children:[Object(a.jsxs)("div",{className:"register-form-div",children:[Object(a.jsx)("h2",{style:{color:"#5f5f5f"},children:"Log In"}),Object(a.jsx)("input",{type:"email",className:"register-name input",placeholder:"Email",value:n,onChange:function(e){return t=e.target.value,void s(t);var t},required:!0}),Object(a.jsx)("input",{type:"password",className:"register-name input",placeholder:"Password",value:d,onChange:function(e){return t=e.target.value,void j(t);var t},required:!0}),Object(a.jsx)("input",{type:"submit",value:"Log In",className:"register-button input"})]}),Object(a.jsxs)("p",{style:{fontSize:"12px"},children:["Not yet registered?"," ",Object(a.jsx)(f.b,{to:"/register",style:{color:"grey"},children:"Register here"})]})]})]})}function x(e){var t=JSON.parse(localStorage.getItem("token")),r=Object(o.useState)([]),n=Object(u.a)(r,2),s=n[0],c=n[1],i=Object(o.useState)([]),d=Object(u.a)(i,2),j=d[0],f=d[1],m=Object(o.useState)(""),x=Object(u.a)(m,2),O=x[0],v=x[1],k=Object(h.e)(),y=function(){var e=Object(p.a)(l.a.mark((function e(){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:3002/user/".concat(t.id),{headers:{Authorization:"Bearer ".concat(t.token)}});case 3:r=e.sent,c(r.data),f(r.data.url),e.next=17;break;case 8:e.prev=8,e.t0=e.catch(0),a=e.t0.message.split(" ")[5],e.t1=a,e.next="404"===e.t1?14:16;break;case 14:return g.b.error("No Polls Found",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",17);case 16:g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(p.a)(l.a.mark((function e(){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("working"),e.prev=1,e.next=4,b.a.post("http://localhost:3002/".concat(t.id),{fullUrl:O},{headers:{Authorization:"Bearer ".concat(t.token)}});case 4:r=e.sent,console.log(r.data),window.location.reload(),e.next=19;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),a=e.t0.message.split(" ")[5],e.t1=a,e.next="404"===e.t1?16:18;break;case 16:return g.b.error("No Polls Found",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",19);case 18:g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 19:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){null===t&&k.push("/"),y()}),[]),console.log(t),console.log(s),console.log(j),Object(a.jsx)("div",{className:"poll-container ",children:Object(a.jsxs)("div",{className:"poll-body",children:[Object(a.jsx)("input",{type:"text",className:"input",placeholder:"Add new URL",onChange:function(e){return t=e.target.value,void v(t);var t}}),Object(a.jsx)("button",{className:"input poll-create-poll-btn",style:{alignSelf:"center"},onClick:function(){return N()},children:"Shorten"}),j.map((function(e){return Object(a.jsxs)("div",{children:[Object(a.jsxs)("p",{children:["Full: ",e.fullUrl]}),Object(a.jsxs)("p",{children:["Short:"," ",Object(a.jsxs)("a",{href:"http://localhost:3002/".concat(e.shortUrl),children:["http://localhost:3002/",e.shortUrl]})]}),Object(a.jsxs)("p",{children:["Clicks:",e.clicks]})]},e._id)}))]})})}var O=r(18),v=r(20),k=function(e){var t=Object(h.e)(),r=Object(o.useState)(!1),n=Object(u.a)(r,2),s=n[0],c=n[1],i=Object(o.useState)([]),d=Object(u.a)(i,2),j=d[0],f=d[1],m=Object(o.useState)(""),x=Object(u.a)(m,2),k=x[0],y=x[1],N=Object(o.useState)(""),C=Object(u.a)(N,2),S=C[0],w=C[1],B=Object(o.useState)(""),P=Object(u.a)(B,2),R=P[0],I=P[1],z=JSON.parse(localStorage.getItem("token")),A=localStorage.getItem("pollName");Object(o.useEffect)((function(){z.adminToken||t.push("/"),function(){var e=Object(p.a)(l.a.mark((function e(){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("https://cyon-poll.herokuapp.com/poll/".concat(localStorage.getItem("pollName")),{headers:{Authorization:"Bearer ".concat(z.token)}});case 3:r=e.sent,f(Object(O.a)(r.data.categories)),c(!1),e.next=20;break;case 8:e.prev=8,e.t0=e.catch(0),a=e.t0.message.split(" ")[5],e.t1=a,e.next="401"===e.t1?14:18;break;case 14:return c(!1),g.b.error("Session expired",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.push("/"),e.abrupt("break",20);case 18:c(!1),g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 20:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}()()}),[]);var T=function(){var e=Object(p.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,b.a.post("https://cyon-poll.herokuapp.com/poll/category",{name:k,pollName:A},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(z.adminToken)}});case 4:t=e.sent,c(!1),f(Object(O.a)(t.data.categories)),y(""),console.log(j),e.next=23;break;case 11:e.prev=11,e.t0=e.catch(1),r=e.t0.message.split(" ")[5],console.log(e.t0.message),e.t1=r,e.next="406"===e.t1?18:21;break;case 18:return c(!1),g.b.error("Category already exist",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",23);case 21:c(!1),g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 23:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(p.a)(l.a.mark((function e(t){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,b.a.post("https://cyon-poll.herokuapp.com/poll/candidate/".concat(t),{name:R,pollName:A},{headers:{"content-type":"application/json",Authorization:"Bearer ".concat(z.adminToken)}});case 4:r=e.sent,c(!1),f(Object(O.a)(r.data.categories)),console.log(r),e.next=21;break;case 10:e.prev=10,e.t0=e.catch(1),a=e.t0.message.split(" ")[5],e.t1=a,e.next="406"===e.t1?16:19;break;case 16:return c(!1),g.b.error("Candidate already exist",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",21);case 19:c(!1),g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 21:console.log(t);case 22:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(p.a)(l.a.mark((function e(t){var r,a,o,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=0;r<j.length;r++)for(a=j[r],o=0;o<a.candidate.length;o++)a.candidate[o]._id==t&&w(j[r]._id);return e.prev=1,e.next=4,b()({url:"https://cyon-poll.herokuapp.com/poll/category/".concat(S,"/candidate/").concat(t),method:"DELETE",data:{pollName:A},headers:{"content-type":"application/json",Authorization:"Bearer ".concat(z.adminToken)}});case 4:n=e.sent,w(""),f(Object(O.a)(n.data.categories)),console.log(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return console.log(A),Object(a.jsxs)("div",{className:"poll-container",children:[Object(a.jsx)(g.a,{limit:1}),s?Object(a.jsx)("p",{children:Object(a.jsx)(v.a,{})}):null,Object(a.jsxs)("div",{className:"poll-body",children:[Object(a.jsxs)("h2",{className:"create-poll-label heading",children:["Poll Name: ",localStorage.getItem("pollName")]}),Object(a.jsx)("button",{className:"poll-create-poll-btn",style:{alignSelf:"flex-start",marginLeft:0},onClick:function(){return t.push("/poll")},children:"Done"}),Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse"},children:[j.map((function(e){return Object(a.jsxs)("div",{className:"create-poll-category",children:[Object(a.jsxs)("p",{className:"create-poll-label sub-heading",style:{textDecoration:"none",marginBottom:0,background:"#000",color:"#fff",fontSize:"18px",marginLeft:0,padding:"10px"},children:["Category: ",e.name]}),Object(a.jsxs)("div",{className:"create-poll-candidate-div",children:[Object(a.jsx)("p",{className:"create-poll-candidate-label",children:"Candidates:"}),e.candidate.map((function(e){return Object(a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(a.jsx)("p",{style:{margin:"2px",fontSize:"18px",marginLeft:"20px"},children:e.name}),Object(a.jsx)("button",{style:{marginRight:"20px",width:"20px",height:"20px",borderRadius:"50%",textAlign:"center",border:"none",background:"rgb(255, 60, 11)",color:"#fff",outline:"none"},value:e._id,onClick:function(e){return L(e.target.value)},children:"x"})]},e._id)})),Object(a.jsx)("input",{type:"text",className:"input",style:{width:"90%",marginBottom:0,borderRadius:"0",borderBottomRightRadius:"8px"},onChange:function(e){return t=e.target.value,void I(t);var t}}),Object(a.jsx)("button",{value:e._id,className:"poll-create-poll-btn",style:{marginTop:0,float:"right",borderRadius:"0"},onClick:function(e){return _(e.target.value)},children:"Add Candidate"})]})]},e._id)})),Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",alignSelf:"flex-end",boxSizing:"border-box",width:"100%",marginRight:0},children:[Object(a.jsx)("input",{type:"text",className:"input",placeholder:"Category name",onChange:function(e){return t=e.target.value,void y(t);var t},value:k,style:{marginRight:0,marginBottom:0,borderRadius:0}}),Object(a.jsx)("button",{className:"poll-create-poll-btn",onClick:T,style:{marginRight:0,marginTop:0,borderRadius:0},children:"Add category"})]})]})]})]})},y=r(41),N=r(42);function C(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(v.b,{})})}function S(e){var t=Object(h.e)(),r=Object(o.useState)([]),n=Object(u.a)(r,2),s=n[0],c=n[1],i=Object(o.useState)(""),d=Object(u.a)(i,2),j=d[0],f=d[1],m=Object(o.useState)(!1),x=Object(u.a)(m,2),v=x[0],k=x[1],S=JSON.parse(localStorage.getItem("token"));Object(o.useEffect)((function(){k(!0),function(){var e=Object(p.a)(l.a.mark((function e(){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("https://cyon-poll.herokuapp.com/poll/".concat(localStorage.getItem("pollName")),{headers:{Authorization:"Bearer ".concat(S.token)}});case 3:0==(r=e.sent).data.categories&&(g.b.error("This Poll is empty",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),setTimeout((function(){return t.push("/poll")}),3e3)),c(Object(O.a)(r.data.categories)),k(!1),e.next=28;break;case 9:e.prev=9,e.t0=e.catch(0),a=e.t0.message.split(" ")[5],e.t1=a,e.next="401"===e.t1?15:"404"===e.t1?19:"405"===e.t1?22:26;break;case 15:return k(!1),g.b.error("Session expired",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.push("/"),e.abrupt("break",28);case 19:return k(!1),g.b.success("Click again to vote",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",28);case 22:return k(!1),g.b.success("Poll Expired",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.push("/poll"),e.abrupt("break",28);case 26:k(!1),g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 28:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}()()}),[]);var w=function(){var e=Object(p.a)(l.a.mark((function e(r){var a,o,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(!0),a=0;case 2:if(!(a<s.length)){e.next=10;break}if(!s[a].candidate.map((function(e){return e._id})).includes(r)){e.next=7;break}return e.next=6,f(s[a]._id);case 6:return e.abrupt("break",10);case 7:a++,e.next=2;break;case 10:return console.log(j),console.log(r),e.prev=12,e.next=15,b.a.post("https://cyon-poll.herokuapp.com/poll/vote/category/".concat(j,"/candidate/").concat(r),{pollName:localStorage.getItem("pollName")},{headers:{"content-type":"application/json",Authorization:"Bearer ".concat(S.token)}});case 15:o=e.sent,c(Object(O.a)(o.data.categories)),f(""),k(!1),console.log(o),e.next=40;break;case 22:e.prev=22,e.t0=e.catch(12),n=e.t0.message.split(" ")[5],e.t1=n,e.next="403"===e.t1?28:"401"===e.t1?31:"404"===e.t1?35:38;break;case 28:return k(!1),g.b.error("You have already voted in this category",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",40);case 31:return k(!1),g.b.error("Session expired",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),t.push("/"),e.abrupt("break",40);case 35:return k(!1),g.b.success("Click again to vote",{position:"top-right",autoClose:3e3,hideProgressBar:"false"}),e.abrupt("break",40);case 38:k(!1),g.b.error("Network error",{position:"top-right",autoClose:3e3,hideProgressBar:"false"});case 40:case"end":return e.stop()}}),e,null,[[12,22]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"poll-container",children:[v?Object(a.jsx)(C,{style:{position:"fixed"}}):null,Object(a.jsxs)("h3",{style:{alignSelf:"flex-start",marginLeft:"20px",color:"#fff",fontSize:"18px",borderBottomStyle:"solid",borderWidth:"5px",padding:"5px"},children:["Poll Name: ",localStorage.getItem("pollName")]}),Object(a.jsx)(g.a,{limit:1}),Object(a.jsxs)("div",{className:"poll-body",style:{justifyContent:"center",alignSelf:"center",marginTop:"40px",borderRadius:0},children:[s.map((function(e){return Object(a.jsxs)("div",{className:"create-poll-candidate-div",children:[Object(a.jsxs)("p",{className:"create-poll-candidate-label",children:["Category: ",e.name]}),e.candidate.map((function(e){return Object(a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:"20px"},children:[Object(a.jsx)("div",{style:{marginBottom:"2px",fontSize:"16px",marginLeft:"25px"},children:e.name}),Object(a.jsxs)("p",{style:{marginRight:"20px"},children:["Votes: ",e.votes]}),Object(a.jsx)("button",{style:{marginRight:"20px",width:"30px",height:"30px",borderRadius:"50%",textAlign:"center",border:"none",color:"#fff",outline:"none"},className:e.voters.includes(S.mobile_id)?"green":"yellow",onClick:function(){return w(e._id)},children:Object(a.jsx)(y.a,{icon:N.a})})]},e._id)}))]},e._id)})),Object(a.jsx)("button",{className:"poll-create-poll-btn",onClick:function(){return t.push("/poll")},children:"Done"})]})]})}function w(){var e=JSON.parse(localStorage.getItem("token"));console.log(e);Object(h.e)();return Object(a.jsx)(a.Fragment,{})}r(73);var B=function(){return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(w,{}),Object(a.jsxs)(f.a,{children:[Object(a.jsx)(h.a,{exact:!0,path:"/",children:Object(a.jsx)(m,{})}),Object(a.jsx)(h.a,{path:"/register",children:Object(a.jsx)(j,{})}),Object(a.jsx)(h.a,{path:"/poll",children:Object(a.jsx)(x,{})}),Object(a.jsx)(h.a,{path:"/create-poll",children:Object(a.jsx)(k,{})}),Object(a.jsx)(h.a,{path:"/vote",children:Object(a.jsx)(S,{})})]})]})},P=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,77)).then((function(t){var r=t.getCLS,a=t.getFID,o=t.getFCP,n=t.getLCP,s=t.getTTFB;r(e),a(e),o(e),n(e),s(e)}))};c.a.render(Object(a.jsx)(n.a.StrictMode,{children:Object(a.jsx)(B,{})}),document.getElementById("root")),P()}},[[74,1,2]]]);
//# sourceMappingURL=main.7ba0e9c6.chunk.js.map